<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Scenario 2 — Hospitality industry</title>
  <link rel="stylesheet" href="../styles.css" />
</head>
<body>
  <a class="skip-link" href="#calc">Skip to calculator</a>

  <header class="site-header container">
    <h1>Scenario 2 — Hospitality industry</h1>
    <p class="muted">Hospitality industry having Tourism Levy, PPDA, VAT.</p>
  </header>

  <main id="calc" class="container" role="main">
    <form id="wht-form" aria-label="Hospitality withholding tax calculator" novalidate>
      <div>
        <label for="invoice-amount"><strong>Invoice amount (total included)</strong></label>
        <input id="invoice-amount" name="invoiceAmount" type="number" inputmode="decimal" step="0.01" required />
      </div>

      <div>
        <label for="vat-rate">VAT rate (%)</label>
        <input id="vat-rate" name="vatRate" type="number" step="0.01" value="17.5" required />
      </div>

      <div>
        <label for="ppda-rate">PPDA rate (%)</label>
        <input id="ppda-rate" name="ppdaRate" type="number" step="0.01" value="1.0" required />
      </div>

      <div>
        <label for="tourism-rate">Tourism levy rate (%)</label>
        <input id="tourism-rate" name="tourismRate" type="number" step="0.01" value="1.0" required />
      </div>

      <fieldset style="margin-top:.5rem; border:1px solid #e6edf3; padding:.5rem; border-radius:6px;">
        <legend style="font-weight:700">Does the invoice include hall hire or conference hall?</legend>
        <label><input id="hall-yes" name="hall" type="radio" value="yes" /> Yes</label>
        <label style="margin-left:1rem"><input id="hall-no" name="hall" type="radio" value="no" checked /> No</label>

        <div id="hall-amount-row" style="margin-top:.5rem; display:none;">
          <label for="hall-amount">Hall hire amount</label>
          <input id="hall-amount" name="hallAmount" type="number" inputmode="decimal" step="0.01" />
        </div>
      </fieldset>

      <fieldset style="margin-top:.5rem; border:1px solid #e6edf3; padding:.5rem; border-radius:6px;">
        <legend style="font-weight:700">Withholding tax rates</legend>

        <div style="display:flex; gap:1rem; flex-wrap:wrap;">
          <div style="flex:1; min-width:200px;">
            <label for="wht-rate">Remaining services WHT rate (%)</label>
            <input id="wht-rate" name="whtRate" type="number" step="0.01" value="3.0" required />
          </div>

          <div style="flex:1; min-width:200px;">
            <label for="hall-wht-rate">Hall hire WHT rate (%)</label>
            <input id="hall-wht-rate" name="hallWhtRate" type="number" step="0.01" value="20.0" required />
          </div>
        </div>
      </fieldset>

      <div style="margin-top:.75rem">
        <button id="calc-btn" type="submit">Calculate</button>
        <button id="reset-btn" type="button">Reset</button>
      </div>
    </form>

    <section id="results" aria-live="polite" style="margin-top:1rem"></section>

    <p style="margin-top:1rem"><a href="../index.html">Back to selection</a></p>
  </main>

  <script type="module">
    import { computeScenario2 } from './scenario2.js';

    const form = document.getElementById('wht-form');
    const results = document.getElementById('results');
    const resetBtn = document.getElementById('reset-btn');
    const hallYes = document.getElementById('hall-yes');
    const hallNo = document.getElementById('hall-no');
    const hallRow = document.getElementById('hall-amount-row');

    function updateHallRow() {
      hallRow.style.display = hallYes.checked ? 'block' : 'none';
    }
    hallYes.addEventListener('change', updateHallRow);
    hallNo.addEventListener('change', updateHallRow);

    function formatCurrency(n) {
      return new Intl.NumberFormat(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 }).format(n);
    }

    form.addEventListener('submit', (e) => {
      e.preventDefault();
      results.innerHTML = '';

      try {
        const invoice = document.getElementById('invoice-amount').value;
        const vatRate = document.getElementById('vat-rate').value;
        const ppdaRate = document.getElementById('ppda-rate').value;
        const tourismRate = document.getElementById('tourism-rate').value;
        const remainingWhtRate = document.getElementById('wht-rate').value;
        const hallWhtRate = document.getElementById('hall-wht-rate').value;
        const hallIncluded = hallYes.checked;
        const hallAmount = document.getElementById('hall-amount').value || 0;

        const out = computeScenario2({
          invoice,
          vatRate,
          ppdaRate,
          tourismRate,
          remainingWhtRate,
          hallHireWhtRate: hallWhtRate,
          hallHireIncluded: hallIncluded,
          hallHireAmount: hallAmount,
          rounding: 2
        });

        results.innerHTML = `
          <div class="result-card">
            <div class="result-row"><div class="result-label">Taxable amount</div><div class="result-value">MK ${formatCurrency(out.taxableAmount)}</div></div>
            <div class="result-row"><div class="result-label">VAT (MK)</div><div class="result-value">MK ${formatCurrency(out.vatAmount)}</div></div>
            <div class="result-row"><div class="result-label">PPDA (MK)</div><div class="result-value">MK ${formatCurrency(out.ppdaAmount)}</div></div>
            <div class="result-row"><div class="result-label">Tourism levy (MK)</div><div class="result-value">MK ${formatCurrency(out.tourismAmount)}</div></div>
            <div class="result-row"><div class="result-label">WHT total (MK)</div><div class="result-value">MK ${formatCurrency(out.whtAmount)}</div></div>
            ${out.whtHall > 0 ? `<div class="result-row"><div class="result-label">WHT on hall hire (MK)</div><div class="result-value">MK ${formatCurrency(out.whtHall)}</div></div>` : ''}
            ${out.whtRemaining > 0 ? `<div class="result-row"><div class="result-label">WHT on remaining services (MK)</div><div class="result-value">MK ${formatCurrency(out.whtRemaining)}</div></div>` : ''}
            <div class="result-row"><div class="result-label">Pay supplier</div><div class="result-value">MK ${formatCurrency(out.paySupplier)}</div></div>
          </div>
        `;
      } catch (err) {
        console.error('Calculation error:', err);
        results.innerHTML = `<div role="alert">Error: ${err.message}</div>`;
      }
    });

    resetBtn.addEventListener('click', () => {
      form.reset();
      results.innerHTML = '';
      document.getElementById('vat-rate').value = '17.5';
      document.getElementById('ppda-rate').value = '1.0';
      document.getElementById('tourism-rate').value = '1.0';
      document.getElementById('wht-rate').value = '3.0';
      document.getElementById('hall-wht-rate').value = '20.0';
      updateHallRow();
    });

    updateHallRow();
  </script>

    <footer class="site-footer container" role="contentinfo" aria-label="Site copyright">
  <div class="footer-inner">
    <div class="attribution-group">
      <p class="attribution">Created for the Balaka District Council Finance Department. This site is provided for informational use only and does not imply endorsement by the Balaka District Council</p>
      <p class="attribution-note">Built for clarity and accessibility.</p>
    </div>

    <p class="copyright">
      © <span id="copyright-year"></span> Wisdom. All rights reserved.
    </p>
  </div>
</footer>

<script>
  (function () {
    const el = document.getElementById('copyright-year');
    if (el) el.textContent = new Date().getFullYear();
  })();
</script>
</body>

</html>
